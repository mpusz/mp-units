
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The quantities and units library for C++">
      
      
        <meta name="author" content="mp-units Team">
      
      
        <link rel="canonical" href="https://mpusz.github.io/mp-units/HEAD/blog/2025/01/15/bringing-quantity-safety-to-the-next-level/">
      
      
        <link rel="prev" href="../../../../2024/11/25/report-from-the-wroc%C5%82aw-2024-iso-c-committee-meeting/">
      
      
        <link rel="next" href="../../../06/16/introducing-absolute-quantities/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../../../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../../../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../../../../assets/images/mp-units-color.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Bringing Quantity-Safety To The Next Level - mp-units</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Bringing Quantity-Safety To The Next Level - mp-units" >
      
        <meta  property="og:description"  content="The quantities and units library for C++" >
      
        <meta  property="og:image"  content="https://mpusz.github.io/mp-units/HEAD/assets/images/social/blog/posts/bringing-quantity-safety-to-the-next-level.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://mpusz.github.io/mp-units/HEAD/blog/2025/01/15/bringing-quantity-safety-to-the-next-level/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Bringing Quantity-Safety To The Next Level - mp-units" >
      
        <meta  name="twitter:description"  content="The quantities and units library for C++" >
      
        <meta  name="twitter:image"  content="https://mpusz.github.io/mp-units/HEAD/assets/images/social/blog/posts/bringing-quantity-safety-to-the-next-level.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bringing-quantity-safety-to-the-next-level" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
You're not viewing the latest version.
<a href="../../../../../..">
  <strong>Click here to go to latest.</strong>
</a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="mp-units" class="md-header__button md-logo" aria-label="mp-units" data-md-component="logo">
      
  <img src="../../../../../assets/images/mp-units-transparent-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mp-units
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Bringing Quantity-Safety To The Next Level
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="custom"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/mpusz/mp-units" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mpusz/mp-units
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../getting_started/introduction/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../users_guide/terms_and_definitions/" class="md-tabs__link">
          
  
  
    
  
  User's Guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../api_reference/" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../tutorials/" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../examples/tags_index/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../../release_notes/" class="md-tabs__link">
        
  
  
    
  
  Release Notes

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="mp-units" class="md-nav__button md-logo" aria-label="mp-units" data-md-component="logo">
      
  <img src="../../../../../assets/images/mp-units-transparent-white.svg" alt="logo">

    </a>
    mp-units
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mpusz/mp-units" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    mpusz/mp-units
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/quick_start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/look_and_feel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Look and Feel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/project_structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Project Structure
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/cpp_compiler_support/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    C++ compiler support (API/ABI)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/installation_and_usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation and Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../getting_started/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    User's Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User's Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/terms_and_definitions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Terms and Definitions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Framework Basics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Framework Basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/interface_introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interface Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/design_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/systems_of_quantities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Systems of Quantities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/systems_of_units/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Systems of Units
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/simple_and_typed_quantities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple and Typed Quantities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/value_conversions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Value Conversions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/character_of_a_quantity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Character of a Quantity
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/dimensionless_quantities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dimensionless Quantities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/quantity_arithmetics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quantity Arithmetics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/generic_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Generic Interfaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/faster_than_lightspeed_constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Faster-than-lightspeed Constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/the_affine_space/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    The Affine Space
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/obtaining_metadata/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Obtaining Metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/framework_basics/text_output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Text Output
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Systems
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/systems/introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/systems/isq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    International System of Quantities (ISQ)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/systems/si/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    International System of Units (SI)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/systems/strong_angular_system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Strong Angular System
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/systems/natural_units/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Natural Units
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Use Cases
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Use Cases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/use_cases/pure_dimensional_analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pure Dimensional Analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/use_cases/working_with_legacy_interfaces/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Legacy Interfaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/use_cases/using_custom_representation_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Custom Representation Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/use_cases/interoperability_with_other_libraries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interoperability with Other Libraries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/use_cases/extending_the_library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extending the Library
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../users_guide/use_cases/wide_compatibility/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Wide Compatibility
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Appendix
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../appendix/glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../appendix/references/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../api_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../../tutorials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tutorials/tutorial_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 1: Refactor to Strong Types
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tutorials/tutorial_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 2: Refactor to Generic, Type-Safe Interfaces
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tutorials/tutorial_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 3: Extracting Numeric Values
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tutorials/tutorial_4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 4: Working with Temperatures
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tutorials/tutorial_5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 5: Affine Spaces and Reference Origins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tutorials/tutorial_6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 6: Interop with std::chrono
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tutorials/tutorial_7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 7: Typed Quantities of the Same Kind
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../tutorials/tutorial_8/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial 8: Custom Units for Dimensionless Counters
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/tags_index/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tags Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    All Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            All Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/hello_units/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hello_units
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/avg_speed/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    avg_speed
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/si_constants/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    si_constants
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../examples/hw_voltage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    hw_voltage
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2024
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2023/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2023
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/metrology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrology
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/releases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releases
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/wg21-updates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WG21 Updates
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../release_notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Release Notes
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="https://avatars.githubusercontent.com/u/506260" alt="Mateusz Pusz">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          <a href="https://github.com/mpusz">Mateusz Pusz</a>
                        
                      </strong>
                      <br>
                      Creator
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2025-01-15 00:00:00+00:00" class="md-ellipsis">January 15, 2025</time>
                      </div>
                    </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
                          <span class="md-ellipsis">
                            in
                            
                              <a href="../../../../category/metrology/">Metrology</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              18 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
            

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#quantity-characters" class="md-nav__link">
    <span class="md-ellipsis">
      Quantity characters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#representation-types" class="md-nav__link">
    <span class="md-ellipsis">
      Representation types
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#character-specific-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Character-specific operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Character-specific operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#current-state-of-the-art" class="md-nav__link">
    <span class="md-ellipsis">
      Current state of the art
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#benefits-of-quantity-safe-library" class="md-nav__link">
    <span class="md-ellipsis">
      Benefits of quantity-safe library
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#explicit-conversions-are-not-really-needed" class="md-nav__link">
    <span class="md-ellipsis">
      Explicit conversions are not really needed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peeking-under-the-hood" class="md-nav__link">
    <span class="md-ellipsis">
      Peeking under the hood
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-do-other-libraries-do" class="md-nav__link">
    <span class="md-ellipsis">
      What do other libraries do?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-challenges" class="md-nav__link">
    <span class="md-ellipsis">
      Implementation challenges
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementation challenges">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#modeling-magnitudes" class="md-nav__link">
    <span class="md-ellipsis">
      Modeling magnitudes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#more-about-displacement-and-position-vector" class="md-nav__link">
    <span class="md-ellipsis">
      More about displacement and position vector
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#affine-spaces-within-quantity-trees" class="md-nav__link">
    <span class="md-ellipsis">
      Affine spaces within quantity trees
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extending-arithmetic-on-quantity-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Extending arithmetic on quantity specifications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-affine-space-abstractions-in-a-quantity_spec" class="md-nav__link">
    <span class="md-ellipsis">
      Defining affine space abstractions in a quantity_spec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-support-to-quantity_point" class="md-nav__link">
    <span class="md-ellipsis">
      Adding support to quantity_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#opening-can-of-worms" class="md-nav__link">
    <span class="md-ellipsis">
      Opening can of worms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#should-we-get-rid-of-a-quantity_point" class="md-nav__link">
    <span class="md-ellipsis">
      Should we get rid of a quantity_point?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  



  
    <a href="https://github.com/mpusz/mp-units/edit/master/docs/blog/posts/bringing-quantity-safety-to-the-next-level.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/mpusz/mp-units/raw/master/docs/blog/posts/bringing-quantity-safety-to-the-next-level.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="bringing-quantity-safety-to-the-next-level">Bringing Quantity-Safety To The Next Level<a class="headerlink" href="#bringing-quantity-safety-to-the-next-level" title="Permanent link">&para;</a></h1>
<p>All quantities and units libraries need to be unit-safe. Most of the libraries
on the market do this correctly. Some of them are also dimension-safe, which
adds another level of protection for their users.</p>
<p><strong>mp-units</strong> is probably the only library on the market that additionally is
quantity-safe. This gives a new quality and possibilities. I've described the
major idea behind it, implementation details, and benefits to the users in the
<a href="../../../../2024/11/04/international-system-of-quantities-isq-part-5---benefits/">series of posts about the International System of Quantities</a>.</p>
<p>However, this is only the beginning. We've always planned more and worked on the
extensions in our free time. In this post, I will describe:</p>
<ul>
<li>What a quantity character is?</li>
<li>The importance of using proper representation types for the quantities.</li>
<li>The power of providing character-specific operations for the quantities.</li>
<li>Discuss implementation challenges and possible solutions.</li>
</ul>
<!-- more -->

<h2 id="quantity-characters">Quantity characters<a class="headerlink" href="#quantity-characters" title="Permanent link">&para;</a></h2>
<p>A quantity character determines the properties and operations that can be performed on the
<a href="../../../../../appendix/glossary/#numerical-value">numerical value of a quantity</a>.</p>
<p>Quantities defined by the ISQ may be of the following characters:</p>
<ul>
<li>real scalar (e.g., <em>time</em>, <em>width</em>, <em>speed</em>, <em>apparent power</em>),</li>
<li>complex scalar (e.g., <em>voltage phasor</em>, <em>complex power</em>, <em>impedance</em>),</li>
<li>vector (e.g., <em>displacement</em>, <em>velocity</em>, <em>force</em>),</li>
<li>tensor (e.g., <em>moment of inertia</em>, <em>stress</em>, <em>strain</em>).</li>
</ul>
<p>From the beginning, <strong>mp-units</strong> V2 was meant to properly support quantities of
various characters. By default, all quantity types are scalars, but we can set
any other quantity character in a <code>quantity_spec</code> definition. For example:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">displacement</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">quantity_character</span><span class="o">::</span><span class="n">vector</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">displacement</span><span class="p">;</span>
</span></code></pre></div>
<p>Character of derived quantities is inherited from the quantity equation taking
into account the operations and their ingredients. For example the below
<em>velocity</em> quantity will automatically get a vector character without the need
to explicitly state it in the definition:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">velocity</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">displacement</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">duration</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">velocity</span><span class="p">;</span>
</span></code></pre></div>
<p>Similarly, the below will yield a <em>speed</em> quantity of a scalar character:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">speed</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">magnitude</span><span class="p">(</span><span class="n">velocity</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
</span></code></pre></div>
<h2 id="representation-types">Representation types<a class="headerlink" href="#representation-types" title="Permanent link">&para;</a></h2>
<p><strong>mp-units</strong> V2 requires providing representation types compatible with a
specific character set in its <code>quantity_spec</code> definition:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">template</span><span class="o">&lt;</span><span class="n">Reference</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="n">RepresentationOf</span><span class="o">&lt;</span><span class="n">get_quantity_spec</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Rep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">double</span><span class="o">&gt;</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="k">class</span><span class="w"> </span><span class="nc">quantity</span><span class="p">;</span>
</span></code></pre></div>
<p>For example, this allows us to check that vector representation type is used to
construct a <em>velocity</em> quantity and to ensure that <em>speed</em> gets a scalar:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">velocity</span><span class="p">(</span><span class="n">q</span><span class="p">);</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1">// quantity speed = isq::speed(q);     // Compile-time error</span>
</span></code></pre></div>
<p>Another example here may be a <em>complex power</em> quantity that should use a representation type
modeling a complex number, but <em>apparent power</em>, <em>active power</em>, and <em>reactive power</em> should
get scalars.</p>
<p>As we can see above, in the case of <code>q</code>, we can use any representation type
with a quantity kind that just specify a unit
(<a href="../../../../../users_guide/framework_basics/simple_and_typed_quantities/#simple-quantities">simple quantities</a>).
However, we need to provide a compatible representation type when we want to use
<a href="../../../../../users_guide/framework_basics/simple_and_typed_quantities/#typed-quantities">strongly-typed quantities</a>
and be quantity-safe.</p>
<p>Such checks already prevent many simple but common errors of mixing similar quantities in
a specific domain.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>It is a common engineering practice to use fundamental types for vector quantities when we know
the direction of the vector. For example, in many cases, we use <code>double</code> to express <em>velocity</em>
or <em>acceleration</em>. In such cases, negative values mean moving backward or decelerating. This
is why we also decided to allow such use cases in the library. A scalar representation type
that provides <code>abs()</code> member or non-member function or works with <code>std::abs()</code> is considered
a one-dimensional vector type:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">speed</span><span class="p">(</span><span class="mi">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">km</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">h</span><span class="p">);</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">velocity</span><span class="p">(</span><span class="mi">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">km</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">h</span><span class="p">);</span>
</span></code></pre></div>
</div>
<h2 id="character-specific-operations">Character-specific operations<a class="headerlink" href="#character-specific-operations" title="Permanent link">&para;</a></h2>
<p>Checking the representation type is only the first step in bringing additional safety.
The real power comes with implementing character-specific operations.</p>
<h3 id="current-state-of-the-art">Current state of the art<a class="headerlink" href="#current-state-of-the-art" title="Permanent link">&para;</a></h3>
<p>Most units libraries on the market (not only for C++) provide only regular
arithmetic operations for scalars and don't constrain them for quantities of
other characters. They also do not offer any
character-specific operations.</p>
<p>For example, let's look closer into vector quantities. Most of the libraries on the market
will happily accept the following or similar code:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">auto</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_force</span><span class="p">();</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="k">auto</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_length</span><span class="p">();</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="k">auto</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">length</span><span class="p">;</span>
</span></code></pre></div>
<p>They will also accept the following line:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">auto</span><span class="w"> </span><span class="n">moment_of_force</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">length</span><span class="p">;</span>
</span></code></pre></div>
<p>Does it mean that <em>moment of force</em> and <em>work</em> are the same quantities? Of
course not! It is just how naive most libraries are today.</p>
<p>But first, to defend them, I must admit that the behavior above is partially OK. <code>force * length</code>
could yield some specific quantity, but it is definitely not <em>work</em> or <em>moment of force</em>.</p>
<p>There are two problems here:</p>
<ol>
<li>Libraries on the market are not aware of the characters of the quantities
    being used in the equation.
    This means they can't prevent scalar arithmetic operations from being
    performed on vector quantities.
    This typically leads to compile-time errors when a proper linear algebra
    representation type is used in a quantity, as most linear algebra libraries
    will not overload <code>operator*</code> for vectors, and those that do, treat it as a
    dot product, which returns a scalar.</li>
<li>None of the libraries allows us to constrain the return type of such multiplication with
    a specific quantity type to specify exactly what we want to achieve. Most of
    them allow for replacing <code>auto</code> with a type that describes just a unit, or,
    at best, the dimension. This means that all of them are unit-safe, and some
    are also dimension-safe. However, this is not helpful here and does not allow
    the library to do any additional compile-time checks on the resulting
    quantities.
    The fact that we named the results as <code>work</code> or <code>moment_of_force</code> does not
    mean anything to the compiler or the library being used.</li>
</ol>
<p>This isn't good.</p>
<h3 id="benefits-of-quantity-safe-library">Benefits of quantity-safe library<a class="headerlink" href="#benefits-of-quantity-safe-library" title="Permanent link">&para;</a></h3>
<p>As we've stated in the beginning, <strong>mp-units</strong>, besides being unit-safe and
dimension-safe, is also quantity-safe. Let's see what it means.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The features described below are planned for the next major release of the library and are
not available on the master branch as of today.</p>
</div>
<p>First, we repeat what other libraries did:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_force</span><span class="p">();</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_length</span><span class="p">();</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">length</span><span class="p">;</span>
</span></code></pre></div>
<p>The code compiles as long as <code>length</code> is a scalar quantity with a scalar representation type.
We can always multiply or divide a vector quantity (e.g., <em>force</em>) by a scalar one.</p>
<p>However, things stop compiling when we want to convert the obtained result to a specific quantity
type:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="c1">// quantity moment_of_force = isq::moment_of_force(q1);  // Compile-time error</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="c1">// quantity work = isq::work(q1);                        // Compile-time error</span>
</span></code></pre></div>
<p>Neither <em>moment of force</em> nor <em>work</em> quantity can be created from a scalar
<em>length</em>. We need very specific vector quantities of kind <em>length</em> to do that:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">displacement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_displacement</span><span class="p">();</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">position_vector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_position_vector</span><span class="p">();</span>
</span></code></pre></div>
<p>Now, if we try to multiply the variables as before, we will end up with a compilation error:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="c1">// quantity q2 = force * displacement;                   // Compile-time error</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="c1">// quantity q3 = force * position_vector;                // Compile-time error</span>
</span></code></pre></div>
<p>Multiplication on vectors is mathematically not defined. We have to use proper operations:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scalar_product</span><span class="p">(</span><span class="n">force</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="p">);</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scalar_product</span><span class="p">(</span><span class="n">force</span><span class="p">,</span><span class="w"> </span><span class="n">position_vector</span><span class="p">);</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_product</span><span class="p">(</span><span class="n">force</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="p">);</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_product</span><span class="p">(</span><span class="n">force</span><span class="p">,</span><span class="w"> </span><span class="n">position_vector</span><span class="p">);</span>
</span></code></pre></div>
<p>All of the above compile and result in some quantities. After that, we can try to convert those
results to our required quantities:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">work</span><span class="p">(</span><span class="n">q2</span><span class="p">).</span><span class="n">in</span><span class="p">[</span><span class="n">J</span><span class="p">];</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="c1">// quantity work = isq::work(q3);                        // Compile-time error</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1">// quantity work = isq::work(q4);                        // Compile-time error</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="c1">// quantity work = isq::work(q5);                        // Compile-time error</span>
</span></code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is essential to realize that just like multiplication and division are for scalars,
vector and scalar products are for vectors. We never want to accept a quantity that
accidentally was created with multiplication instead of division of its arguments or
with the scalar product instead of a vector product, right?</p>
</div>
<p>So we are done with <em>work</em>. Let's create a <em>moment of force</em> quantity as well.
It might be surprising to many that none of the following code compiles:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="c1">// quantity moment_of_force = isq::moment_of_force(q2);  // Compile-time error</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="c1">// quantity moment_of_force = isq::moment_of_force(q3);  // Compile-time error</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1">// quantity moment_of_force = isq::moment_of_force(q4);  // Compile-time error</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="c1">// quantity moment_of_force = isq::moment_of_force(q5);  // Compile-time error</span>
</span></code></pre></div>
<p>Do you know why it does not compile? Please try to think about it for a minute
and figure out what is the problem before checking the answer below.</p>
<details class="tip">
<summary>!!! Spoiler alert !!!</summary>
<p>Vector product is anti-commutative. Similarly to the division for scalars, for a vector product
it is important to decide which quantity we put on the left and right-hand side of the
operation.</p>
<p>To make it compile, we need to reverse the arguments of a <code>vector_product()</code> operation:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vector_product</span><span class="p">(</span><span class="n">position_vector</span><span class="p">,</span><span class="w"> </span><span class="n">force</span><span class="p">);</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">moment_of_force</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">moment_of_force</span><span class="p">(</span><span class="n">q6</span><span class="p">);</span>
</span></code></pre></div>
</details>
<p>Do you start to see the need for such checks at compile-time already? <img alt="🤓" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f913.svg" title=":nerd:" /></p>
<h3 id="explicit-conversions-are-not-really-needed">Explicit conversions are not really needed<a class="headerlink" href="#explicit-conversions-are-not-really-needed" title="Permanent link">&para;</a></h3>
<p>You may be worried by the fact that we needed explicit quantity conversions above
and that the code without them compiled fine. It might look like a safety
pitfall, but it is really not an issue.</p>
<p>The code above used a <code>quantity</code> <abbr title="Class Template Argument Deduction">CTAD</abbr> placeholder which works a bit like <code>auto</code>.
It accepts any quantity and deduced proper type for it. And all of the above
operations resulted in some
quantities, but often not the ones we were interested in.</p>
<p>In the production code, we deal with strong types in many places (members in classes, function
arguments and return types, etc.). In generic code, we should use concepts to constrain template
parameters. This will be enough to guarantee quantity-safety.</p>
<p>For example:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kt">void</span><span class="w"> </span><span class="nf">func1</span><span class="p">(</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">work</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">w</span><span class="p">);</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="kt">void</span><span class="w"> </span><span class="nf">func2</span><span class="p">(</span><span class="n">QuantityOf</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">moment_of_force</span><span class="o">&gt;</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">mof</span><span class="p">);</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">func1</span><span class="p">(</span><span class="n">q2</span><span class="p">);</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">func2</span><span class="p">(</span><span class="n">q6</span><span class="p">);</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="c1">// func1(q6);  // Compile-time error</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c1">// func2(q2);  // Compile-time error</span>
</span></code></pre></div>
<h3 id="peeking-under-the-hood">Peeking under the hood<a class="headerlink" href="#peeking-under-the-hood" title="Permanent link">&para;</a></h3>
<p>Let's look at the definitions of <em>work</em> and <em>moment of force</em> quantities to
understand how and why the above works:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">work</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">scalar_product</span><span class="p">(</span><span class="n">force</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">work</span><span class="p">;</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">moment_of_force</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">vector_product</span><span class="p">(</span><span class="n">position_vector</span><span class="p">,</span><span class="w"> </span><span class="n">force</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">moment_of_force</span><span class="p">;</span>
</span></code></pre></div>
<p><code>scalar_product()</code> and <code>vector_product()</code> functions are overloaded not only for
<code>quantity</code> but also for <code>quantity_spec</code> types. The results of such operations
are symbolic expressions that
identify those operations. When used as a quantity recipe in a <code>quantity_spec</code>
definition, they tell the library which derived quantities may be implicitly
converted to our quantity.</p>
<h3 id="what-do-other-libraries-do">What do other libraries do?<a class="headerlink" href="#what-do-other-libraries-do" title="Permanent link">&para;</a></h3>
<p>I am probably not wrong in stating that none of the major C++ units libraries on
the market provides vector or complex operations on quantities. This is why none
of them will work when a proper representation type will be provided to a
quantity. Trying to do any operations on a quantity with a linear algebra vector
as its representation type will fail to compile.</p>
<p>This is also mostly true for other programming languages.
A great exception, and in fact the only library that I know which provides such
operations, is Python's
<a href="https://pint.readthedocs.io/en/stable/user/numpy.html#Function/Method-Support">Pint</a>
(thanks to <a href="https://numpy.org/doc/stable/index.html">NumPy</a> support).</p>
<p>As other libraries do not support quantities of a vector type, they require users to create
homogenous vectors of quantities and do all of the linear algebra operations with a 3rd party
library. This approach can't be quantity-safe!</p>
<p>In such scenarios, the units library can't detect if an external linear algebra library performs
a scalar or vector product operation. It only observes the individual multiplications on scalar
ingredients of an external vector type. This is actually why such multiplication
operations are provided in other units libraries in the first place.</p>
<p>Let's compare those approaches:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Quantity-Safe</label><label for="__tabbed_1_2">Also Quantity-Safe</label><label for="__tabbed_1_3">Other units libraries</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">displacement_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">displacement</span><span class="p">(</span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">displacement_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">displacement</span><span class="p">(</span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="n">quantity</span><span class="w"> </span><span class="n">displacement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">displacement_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displacement_2</span><span class="p">;</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">quantity</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">force</span><span class="p">(</span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">);</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="n">quantity</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">work</span><span class="p">(</span><span class="n">scalar_product</span><span class="p">(</span><span class="n">force</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="p">));</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">displacement_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">displacement_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">quantity</span><span class="w"> </span><span class="n">displacement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">displacement_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displacement_2</span><span class="p">;</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">quantity</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">;</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="n">quantity</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">work</span><span class="p">[</span><span class="n">J</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scalar_product</span><span class="p">(</span><span class="n">force</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="p">);</span>
</span></code></pre></div>
</div>
<div class="tabbed-block">
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">displacement_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">};</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">displacement_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">};</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">displacement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">displacement_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displacement_2</span><span class="p">;</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">quantity</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">newton</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">la</span><span class="o">::</span><span class="n">vector</span><span class="p">{</span><span class="mi">42</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">,</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">N</span><span class="p">};</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="n">quantity</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">joule</span><span class="o">&gt;</span><span class="w"> </span><span class="n">work</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">la</span><span class="o">::</span><span class="n">scalar_product</span><span class="p">(</span><span class="n">force</span><span class="p">,</span><span class="w"> </span><span class="n">displacement</span><span class="p">);</span>
</span></code></pre></div>
</div>
</div>
</div>
<p>Of course, someone could argue that incorrect use of a vector product operation
above would also be safe as it will not compile as the return type differs. Yes,
it is true. However, please
remember that there are more cases where errors may happen.</p>
<p>For example, an external linear algebra library will not protect us from
providing arguments to a vector product in an invalid order.</p>
<p>Also, our <code>work</code> quantity will never be able to detect if what we are trying to
assign to it is a result of a scalar product of two vector quantities of
<em>displacement</em> and <em>force</em>, or maybe just some naive multiplication of scalar
quantities that accidentally matched the dimensionality of the expected result.</p>
<p>Please also remember that the quantity characters are not only about linear algebra. For example,
in the case of complex quantities, we want to ensure that only:</p>
<ul>
<li>the real part of a <em>complex power</em> is assigned to an <em>active power</em>,</li>
<li>the imaginary part of a <em>complex power</em> is assigned to an <em>reactive power</em>,</li>
<li>the modulus of a <em>complex power</em> is assigned to an <em>apparent power</em>.</li>
</ul>
<p>Mixing the above is a fatal error in power systems engineering.</p>
<h2 id="implementation-challenges">Implementation challenges<a class="headerlink" href="#implementation-challenges" title="Permanent link">&para;</a></h2>
<p>I had planned to implement the above features for a few years now but never had
enough time to do it. Now, I am close to finishing the work. However, I've
discovered a few interesting issues on the way, and I have to solve them before
putting my code on the mainline and releasing the next <strong>mp-units</strong> version.</p>
<h3 id="modeling-magnitudes">Modeling magnitudes<a class="headerlink" href="#modeling-magnitudes" title="Permanent link">&para;</a></h3>
<p>Let's dig in a bit more into proper modelling of <em>position vector</em> and <em>displacement</em> quantities.
First, we have to think to which scalar quantities their magnitude should convert to:</p>
<ul>
<li>a magnitude of a <em>position vector</em> is equivalent to a <em>radial distance</em> quantity,</li>
<li>a magnitude of a <em>displacement</em> is a special case of a <em>distance</em> quantity.</li>
</ul>
<p>Taking the above into account, we should refactor our tree of quantities of kind <em>length</em> into
the following:</p>
<pre class="mermaid"><code>flowchart TD
    length["&lt;b&gt;length&lt;/b&gt;&lt;br&gt;[m]"]
    length --- width["&lt;b&gt;width&lt;/b&gt; / &lt;b&gt;breadth&lt;/b&gt;"]
    length --- height["&lt;b&gt;height&lt;/b&gt; / &lt;b&gt;depth&lt;/b&gt; / &lt;b&gt;altitude&lt;/b&gt;"]
    width --- thickness["&lt;b&gt;thickness&lt;/b&gt;"]
    width --- diameter["&lt;b&gt;diameter&lt;/b&gt;"]
    width --- radius["&lt;b&gt;radius&lt;/b&gt;"]
    radius --- radius_of_curvature["&lt;b&gt;radius_of_curvature&lt;/b&gt;"]
    length --- path_length["&lt;b&gt;path_length&lt;/b&gt;"]
    path_length --- distance["&lt;b&gt;distance&lt;/b&gt;"]
    distance --- displacement["&lt;b&gt;displacement&lt;/b&gt;&lt;br&gt;{vector}"]
    distance --- radial_distance["&lt;b&gt;radial_distance&lt;/b&gt;"]
    radial_distance --- position_vector["&lt;b&gt;position_vector&lt;/b&gt;&lt;br&gt;{vector}"]
    length --- wavelength["&lt;b&gt;wavelength&lt;/b&gt;"]</code></pre>
<p>Having the above, we can look a bit closer into how <em>velocity</em> and <em>speed</em> are
defined in the ISQ:</p>
<div class="admonition quote">
<p class="admonition-title">ISO 80000-3: Space and time</p>
<p><strong><em>velocity</em></strong> - vector quantity giving the rate of change of a <em>position vector</em>.</p>
<p><strong><em>speed</em></strong> - magnitude of the <em>velocity</em>.</p>
</div>
<p>Change of a <em>position vector</em> is nothing else than a <em>displacement</em>. This means that <em>velocity</em>
and <em>speed</em> can be defined as follows:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">velocity</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">displacement</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">duration</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">velocity</span><span class="p">;</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">speed</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">magnitude</span><span class="p">(</span><span class="n">velocity</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
</span></code></pre></div>
<p>This is compatible with the ISQ definitions. However, we should check what it means from the
engineering point of view. Let's assume that we want to calculate <em>speed</em> directly from
a <em>distance</em> traveled and <em>duration</em>, without using any vector quantities like <em>displacement</em>
or <em>velocity</em>:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="n">quantity</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">distance</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="n">quantity</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">duration</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">s</span><span class="p">;</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="c1">// quantity&lt;isq::speed[m / s]&gt; speed = distance / duration;  // Compile-time error</span>
</span></code></pre></div>
<p>The above does not compile because <em>distance</em> quantity is not implicitly convertible to
<em>magnitude(displacement)</em>. This is the same case as stating that not every <em>length</em> is
a <em>distance</em>. We need to cast here explicitly. To fix it, we can do any of the below:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="n">quantity</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">speed</span><span class="p">[</span><span class="n">m</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">s</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">speed1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">speed</span><span class="p">(</span><span class="n">distance</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">duration</span><span class="p">);</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="n">quantity</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">speed</span><span class="p">[</span><span class="n">m</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">s</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">speed2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">magnitude</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">displacement</span><span class="p">)(</span><span class="n">distance</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">duration</span><span class="p">;</span>
</span></code></pre></div>
<p>Also, the following will work:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">length_kind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">42</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">;</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="n">quantity</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">speed</span><span class="p">[</span><span class="n">m</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">s</span><span class="p">]</span><span class="o">&gt;</span><span class="w"> </span><span class="n">speed3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">length_kind</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">duration</span><span class="p">;</span>
</span></code></pre></div>
<p>If we do not specify a specific quantity type and just use an SI unit, then we deal with the
kind of quantity. Such quantity can behave like any quantity from the hierarchy tree with
the same character, so it is also the same as <code>magnitude(isq::displacement)</code>.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Is it good enough from the engineering and usability point of views? If you would like to
share your thoughts, please provide your comments below the article.</p>
</div>
<h3 id="more-about-displacement-and-position-vector">More about <em>displacement</em> and <em>position vector</em><a class="headerlink" href="#more-about-displacement-and-position-vector" title="Permanent link">&para;</a></h3>
<p>As we've stated above, a change of <em>position vector</em> is a <em>displacement</em>. Let's try to calculate
it here:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">pos1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">position_vector</span><span class="p">(</span><span class="n">vector</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">quantity</span><span class="w"> </span><span class="n">pos2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">position_vector</span><span class="p">(</span><span class="n">vector</span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">m</span><span class="p">);</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pos1</span><span class="p">;</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="c1">// quantity&lt;isq::displacement[m], vector&gt; displacement = q7;  // Compile-time error</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="c1">// quantity displacement = isq::displacement(q7);             // Compile-time error</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="n">quantity</span><span class="w"> </span><span class="n">displacement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quantity_cast</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">displacement</span><span class="o">&gt;</span><span class="p">(</span><span class="n">q7</span><span class="p">);</span>
</span></code></pre></div>
<p>Again, the above might be surprising and considered a usability issue. Let me
describe why the code behaves like that.</p>
<p>As of today, the result of an addition or subtraction of two quantities is their common quantity
type. When subtracting two <em>position vectors</em> we end up with a <em>position vector</em>.
Looking at the above hierarchy tree, we can easily see that <em>position vector</em> and
<em>displacement</em> are on different branches. This prevents implicit and explicit conversions
between those. The only one allowed to force such a conversion is an explicit cast.</p>
<p>If we think more about it, this makes a lot of sense. <em>Position vector</em> is not a special
case of <em>displacement</em> or vice versa. Those should not be convertible. We do not want the code
to compile when we accidentally pass a <em>position vector</em> to the numerator of the equation for
<em>velocity</em>, right? What does calculating the <em>velocity</em> for a <em>position vector</em> mean?</p>
<h3 id="affine-spaces-within-quantity-trees">Affine spaces within quantity trees<a class="headerlink" href="#affine-spaces-within-quantity-trees" title="Permanent link">&para;</a></h3>
<p>Also, let's look at the type of variable <code>q7</code>. We know that subtracting two
quantities of the same type results in a quantity of the same type. This is also the case
when we do it for <em>position vectors</em>. We will see the same resulting type when we add two
<em>position vectors</em> as well. But wait... What does it actually mean to add two <em>position vectors</em>?</p>
<p>Looks familiar? Yes, we can clearly see that we are dealing with yet another case of
the <a href="../../../../../users_guide/framework_basics/the_affine_space/">affine space</a>. This time, it is
hidden within the quantities hierarchy tree. This also means that adding a <em>position vector</em>
and a <em>displacement</em> should result in a <em>position vector</em>. Let's try to do it:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="n">quantity</span><span class="w"> </span><span class="n">q8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displacement</span><span class="p">;</span><span class="w">                       </span><span class="c1">// Often a compile-time error</span>
</span></code></pre></div>
<p>Unfortunately, this often fails on the very first step, even before assigning the result to
the <em>position vector</em> quantity. The reason for this is that in the hierarchy
tree, the first common node for <em>position vector</em> and <em>displacement</em> is
<em>distance</em>, which is a scalar quantity. Trying
to use a vector representation type for a scalar quantity yields an error as a result of already
existing checks described in the <a href="#representation-types">Representation types</a> chapter.</p>
<p>However, the code will compile if we use the same representation type for scalar and vector
quantity (e.g., <code>int</code> or <code>double</code> may be used as a vector representation type for a well-known
axis). In this case, we will end up with:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="c1">// quantity&lt;isq::position_vector[m], vector&gt; pos3 = q8;       // Compile-time error</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="n">quantity</span><span class="o">&lt;</span><span class="n">isq</span><span class="o">::</span><span class="n">position_vector</span><span class="p">[</span><span class="n">m</span><span class="p">],</span><span class="w"> </span><span class="n">vector</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pos3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">position_vector</span><span class="p">(</span><span class="n">q8</span><span class="p">);</span>
</span></code></pre></div>
<p>We need to convert a <em>distance</em> explicitly to a <em>position vector</em> quantity to move "down" over
a branch in a hierarchy tree.</p>
<p>It is important to note that there are more quantities that may behave the same. For example,
<em>altitude</em>/<em>height</em> and <em>time</em>/<em>duration</em> may also form similar affine spaces. More similar
examples can be found in other hierarchy trees.</p>
<h3 id="extending-arithmetic-on-quantity-specifications">Extending arithmetic on quantity specifications<a class="headerlink" href="#extending-arithmetic-on-quantity-specifications" title="Permanent link">&para;</a></h3>
<p><strong>mp-units</strong> provided support for multiplication and division of <code>quantity_spec</code> from the
beginning. It was needed to obtain derived quantities. Adding support for quantity characters
also added special operations (e.g., <code>magnitude()</code>, <code>scalar_product()</code>, etc.) on <code>quantity_spec</code>
arguments. If we want to support such affine space abstractions, we must also add support
for addition and subtraction, which may yield different results.</p>
<p>For example:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">static_assert</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">length</span><span class="p">);</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="k">static_assert</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">height</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">width</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">length</span><span class="p">);</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="k">static_assert</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">altitude</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">height</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">altitude</span><span class="p">);</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="k">static_assert</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">height</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">altitude</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">altitude</span><span class="p">);</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="k">static_assert</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">length</span><span class="p">);</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="k">static_assert</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">height</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">width</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">length</span><span class="p">);</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="k">static_assert</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">altitude</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">height</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">altitude</span><span class="p">);</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="k">static_assert</span><span class="p">(</span><span class="n">isq</span><span class="o">::</span><span class="n">altitude</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">altitude</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">isq</span><span class="o">::</span><span class="n">height</span><span class="p">);</span>
</span></code></pre></div>
<p>Also, some operations should not compile. For example:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1">// auto qs1 = isq::altitude + isq::altitude;  // Compile-time error</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="c1">// auto qs2 = isq::height - isq::altitude;    // Compile-time error</span>
</span></code></pre></div>
<h3 id="defining-affine-space-abstractions-in-a-quantity_spec">Defining affine space abstractions in a <code>quantity_spec</code><a class="headerlink" href="#defining-affine-space-abstractions-in-a-quantity_spec" title="Permanent link">&para;</a></h3>
<p>We can add support for the above by adding <code>point_for&lt;QuantitySpec&gt;</code> attribute to the
<code>quantity_spec</code> definition:</p>
<div class="language-cpp highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">height</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">length</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">height</span><span class="p">;</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">altitude</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">point_for</span><span class="o">&lt;</span><span class="n">height</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">altitude</span><span class="p">;</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">displacement</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">distance</span><span class="p">,</span><span class="w"> </span><span class="n">quantity_character</span><span class="o">::</span><span class="n">vector</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">displacement</span><span class="p">;</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="kr">inline</span><span class="w"> </span><span class="k">constexpr</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">position_vector</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">quantity_spec</span><span class="o">&lt;</span><span class="n">radial_distance</span><span class="p">,</span><span class="w"> </span><span class="n">point_for</span><span class="o">&lt;</span><span class="n">displacement</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">quantity_character</span><span class="o">::</span><span class="n">vector</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="n">position_vector</span><span class="p">;</span>
</span></code></pre></div>
<p>Thanks to the above, the library always knows a "delta" quantity for a "point" type. I've
implemented this logic, got great results, and thought I was done. But next, I realized that
I need to update a few more things.</p>
<h3 id="adding-support-to-quantity_point">Adding support to <code>quantity_point</code><a class="headerlink" href="#adding-support-to-quantity_point" title="Permanent link">&para;</a></h3>
<p><code>quantity_point</code> is intended to model "point" quantities and return "delta" quantities on
subtraction or by calling <code>.quantity_from...()</code> family of member functions. This
is possible and can be done. I've finished most of the implementation already.
However, two interesting questions
arise:</p>
<ol>
<li>Should <code>isq::altitude</code> be reserved only for <code>quantity_point</code> and not available for
   "regular" <code>quantity</code> types?</li>
<li>Should <code>isq::height</code> apply only to <code>quantity</code>?</li>
</ol>
<p>I think that question #1 makes a lot of sense. If we realize that <code>quantity</code> always represents
"delta" quantities, what would a <code>quantity</code> of <code>isq::altitude</code> mean? However, forcing the
usage of <code>quantity_point</code> might be too strict here. Some users are not familiar
or comfortable with this abstraction. Also, we can't multiply or divide
quantity points.</p>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>Does anyone know a derived quantity built with altitude or time instant? If so, please let me
know in the comments, as limiting "point" <code>quantity_spec</code> to <code>quantity_point</code> would prevent
forming such derived quantities.</p>
</div>
<p>Question #2 is also interesting. However, in this case, I think that the answer should be "NO".
I can imagine a series of <em>height</em> measurements. Every physical measurement can
be modeled as a <code>quantity_point</code>, so a <code>quantity_point</code> of <em>height</em> might make
sense.</p>
<h3 id="opening-can-of-worms">Opening can of worms<a class="headerlink" href="#opening-can-of-worms" title="Permanent link">&para;</a></h3>
<p>So far, so good. I thought I was done here and could continue my work on symbolic expressions
for vector and complex quantities. However, I've realized that I've opened a can of worms.
What about the convertibility of <code>quantity_spec</code>? How should <code>common_quantity_spec()</code> behave?</p>
<p>Let's start with conversions. It might seem easy. <code>isq::altitude</code> and
<code>isq::height</code> should not be convertible to each other. But more questions arise:</p>
<ol>
<li>Should it be possible to <code>quantity_cast</code> from <code>isq::altitude</code> to <code>isq::height</code> or vice versa?</li>
<li>Should <code>isq::height</code> be convertible to <code>isq::length</code>?</li>
<li>Should <code>isq::length</code> be explicitly convertible to <code>isq::height</code>?</li>
<li>Should <code>isq::altitude</code> be convertible to <code>isq::length</code>?</li>
<li>Should <code>isq::length</code> be explicitly convertible to <code>isq::altitude</code>?</li>
</ol>
<p>The need for #1 will always probably mean an error in program logic, so <code>quantity_cast</code> could
not work for such entities. This would be an exception to our conversion rules that always
allow casting between branches of one tree.</p>
<p>The answer to questions #2 and #3 is "YES".</p>
<p>We might be tempted to say "NO" to questions #4 and #5 as <code>isq::altitude</code> is defined as "point"
while <code>isq::length</code> is not specified as such. However, I've just realized that
it is not the case.</p>
<p>The proper answer to questions #4 and #5 is "It depends". If we are dealing with a <code>quantity_point</code>
then converting from <code>isq::altitude</code> to <code>isq::length</code> or the other way around
should work. However, it would probably be a bad idea for a <code>quantity</code> type.</p>
<p>It turns out that <code>common_quantity_spec()</code> is similar. It is probably safe to
state that it should not compile for <code>isq::altitude</code> and <code>isq::height</code>
arguments. This means that we will not be able to compare such quantities as
well. As those are different abstractions, preventing that might be an
excellent idea.</p>
<p>Again, it gets tricky if we consider passing <code>isq::length</code> and <code>isq::altitude</code> to it. For
<code>quantity_point</code> it probably should work fine and fail to compile for <code>quantity</code>.</p>
<p>The above means that to determine the conversion rules and common quantity
specifications, we need to know the context in which the <code>quantity_spec</code> is
being used. This sucks!</p>
<h3 id="should-we-get-rid-of-a-quantity_point">Should we get rid of a <code>quantity_point</code>?<a class="headerlink" href="#should-we-get-rid-of-a-quantity_point" title="Permanent link">&para;</a></h3>
<p>There are at least two ways of solving the above issue. In any case, we need to
introduce a wrapper over the <code>quantity_spec</code> to denote it is being used in a
"point" abstraction.</p>
<p>A simpler solution could be implicitly amending the <code>Reference</code> provided to the <code>quantity_point</code>
class template with <code>point&lt;...&gt;</code>. So, for example, we would have the following members in
<code>quantity_point&lt;isq::altitude[m]&gt;</code>:</p>
<ul>
<li><code>qp::quantity_spec == point&lt;isq::altitude&gt;</code>,</li>
<li><code>qp::reference</code> of a type <code>reference&lt;point&lt;isq::altitude&gt;, si::metre&gt;</code>.</li>
</ul>
<p>This should work but might be a bit confusing as members of the class template would not exactly
contain the types of template parameters.</p>
<p>A better solution might be removing a dedicated <code>quantity_point</code> abstraction
and providing both functionalities through the <code>quantity</code> class template. I
still haven't figured out the best syntax.
Please let me know if you have good ideas in the comments below. Here are some rough ideas:</p>
<table>
<thead>
<tr>
<th>Before</th>
<th>After</th>
<th><code>quantity_spec</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><code>quantity&lt;si::metre&gt;</code></td>
<td><code>quantity&lt;si::metre&gt;</code></td>
<td><code>kind_of&lt;isq::length&gt;</code></td>
</tr>
<tr>
<td><code>quantity_point&lt;si::metre&gt;</code></td>
<td><code>quantity&lt;point&lt;si::metre&gt;&gt;</code></td>
<td><code>point&lt;kind_of&lt;isq::length&gt;&gt;</code></td>
</tr>
<tr>
<td><code>quantity_point&lt;si::metre, mean_sea_level&gt;</code></td>
<td><code>quantity&lt;point&lt;si::metre, mean_sea_level&gt;&gt;</code></td>
<td><code>point&lt;kind_of&lt;isq::length&gt;&gt;</code></td>
</tr>
<tr>
<td><code>quantity&lt;isq::height[m]&gt;</code></td>
<td><code>quantity&lt;isq::height[m]&gt;</code></td>
<td><code>isq::height</code></td>
</tr>
<tr>
<td><code>quantity_point&lt;isq::height[m]&gt;</code></td>
<td><code>quantity&lt;point&lt;isq::height[m]&gt;&gt;</code></td>
<td><code>point&lt;isq::height&gt;</code></td>
</tr>
<tr>
<td><code>quantity_point&lt;isq::altitude[m]&gt;</code></td>
<td><code>quantity&lt;point&lt;isq::altitude[m]&gt;&gt;</code></td>
<td><code>point&lt;isq::altitude&gt;</code></td>
</tr>
<tr>
<td><code>quantity_point&lt;isq::altitude[m], mean_sea_level&gt;</code></td>
<td><code>quantity&lt;point&lt;isq::altitude[m], mean_sea_level&gt;&gt;</code></td>
<td><code>point&lt;isq::altitude&gt;</code></td>
</tr>
</tbody>
</table>
<p>I am still undecided about whether we should pursue this option, which would
involve a huge design change in the library. It may even require bumping the
library major version to V3.</p>
<p>On the bright side, it would limit the number of abstractions in the library.
It would also make the library more consistent with standards like ISO/IEC
80000, which talk about quantities and do not mention quantity points at all.
This could also be useful before we start our work on the next big task -
logarithmic quantities and units.</p>







  
  




  



<h2 id="__comments">Comments</h2>
<script src="https://giscus.app/client.js" data-repo="mpusz/mp-units" data-repo-id="MDEwOlJlcG9zaXRvcnkxNDU2OTIwNDY="
  data-category="Blog comments" data-category-id="DIC_kwDOCK8Vjs4Ci6_o" data-mapping="pathname" data-strict="0"
  data-reactions-enabled="1" data-emit-metadata="1" data-input-position="bottom" data-theme="preferred_color_scheme"
  data-lang="en" crossorigin="anonymous" async>
  </script>

<!-- Synchronize Giscus theme with palette -->
<script>
  var giscus = document.querySelector("script[src*=giscus]")

  // Set palette on initial load
  var palette = __md_get("__palette")
  if (palette && typeof palette.color === "object") {
    var theme = palette.color.scheme === "slate"
      ? "transparent_dark"
      : "light"

    // Instruct Giscus to set theme
    giscus.setAttribute("data-theme", theme)
  }

  // Register event handlers after documented loaded
  document.addEventListener("DOMContentLoaded", function () {
    var ref = document.querySelector("[data-md-component=palette]")
    ref.addEventListener("change", function () {
      var palette = __md_get("__palette")
      if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate"
          ? "transparent_dark"
          : "light"

        // Instruct Giscus to change theme
        var frame = document.querySelector(".giscus-frame")
        frame.contentWindow.postMessage(
          { giscus: { setConfig: { theme } } },
          "https://giscus.app"
        )
      }
    })
  })
</script>

      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../../../2024/11/25/report-from-the-wroc%C5%82aw-2024-iso-c-committee-meeting/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Report from the Wrocław 2024 ISO C++ Committee meeting">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Report from the Wrocław 2024 ISO C++ Committee meeting
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../06/16/introducing-absolute-quantities/" class="md-footer__link md-footer__link--next" aria-label="Next: Introducing absolute quantities">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Introducing absolute quantities
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2018-2023 Mateusz Pusz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../../../..", "features": ["content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "navigation.indexes", "navigation.tabs", "navigation.footer", "navigation.top", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../../../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../../../javascripts/ce_embed.js"></script>
      
        <script src="../../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>